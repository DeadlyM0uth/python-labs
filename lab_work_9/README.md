
# –û—Ç—á—ë—Ç –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏ –≤–∞–ª—é—Ç (lab_work_9)

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
- –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python (–º–∏–∫—Ä–æ-framework –Ω–∞ –±–∞–∑–µ `http.server`) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏ –≤–∞–ª—é—Ç.
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É MVC (Models, Views, Controllers).
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π: `currency`, `user`, `user_currency`.
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–µ–º—É API (–¶–ë –†–§) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –∏ –∏—Ö –ø–∞—Ä—Å–∏–Ω–≥.
- –ü–æ–∫—Ä—ã—Ç—å –∫–ª—é—á–µ–≤—ã–µ —É—á–∞—Å—Ç–∫–∏ –∫–æ–¥–∞ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `unittest` –∏ `unittest.mock`.

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

- Models (`myapp/models`):
	- `Author`, `App` ‚Äî –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∞–≤—Ç–æ—Ä, –Ω–∞–∑–≤–∞–Ω–∏–µ, –≤–µ—Ä—Å–∏—è).
	- `User` ‚Äî –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (id, name).
	- `Currency` ‚Äî –º–æ–¥–µ–ª—å –≤–∞–ª—é—Ç—ã (id, num_code, char_code, name, value, nominal).
	- `UserCurrency` ‚Äî –º–æ–¥–µ–ª—å –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≤–∞–ª—é—Ç—É (id, user_id, currency_id).
- Controllers (`myapp/controllers`):
	- `database_controller.py` ‚Äî —Å–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º (CurrencyRatesCRUD): CRUD –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SQLite.
	- `currency_controller.py` ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –Ω–∞–¥ –≤–∞–ª—é—Ç–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
	- `pages.py` ‚Äî —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ HTML-—à–∞–±–ª–æ–Ω–æ–≤ —Å Jinja2 (`PageRenderer`).
- Utilities (`myapp/utils`):
	- `currencies_api.py` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –ø–∞—Ä—Å–∏–Ω–≥ XML –æ—Ç API –¶–ë –†–§.
- Templates (`myapp/templates`):
	- `index.html`, `users.html`, `user_detail.html`, `currencies.html`, `author.html` ‚Äî Jinja2 —à–∞–±–ª–æ–Ω—ã.
- –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `run.py` –∑–∞–ø—É—Å–∫–∞–µ—Ç `myapp.myapp.main()`.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
lab_work_9/
‚îú‚îÄ‚îÄ myapp/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ myapp.py                         # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (HTTPServer –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ author.py                    # –ú–æ–¥–µ–ª—å Author
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.py                       # –ú–æ–¥–µ–ª—å App
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                      # –ú–æ–¥–µ–ª—å User
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ currency.py                  # –ú–æ–¥–µ–ª—å Currency
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_currency.py             # –ú–æ–¥–µ–ª—å UserCurrency
‚îÇ   ‚îú‚îÄ‚îÄ controllers/                     
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database_controller.py       # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ currency_controller.py       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤–∞–ª—é—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pages.py                     # –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ Jinja2 —à–∞–±–ª–æ–Ω–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html                   # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.html                   # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_detail.html             # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ currencies.html              # –°–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç –∏–∑ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ author.html                  # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ
‚îÇ   ‚îú‚îÄ‚îÄ static/                          # CSS –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ currencies_api.py            # –§—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ test_server.py                       # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã 
‚îú‚îÄ‚îÄ test_models.py                       # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ test_currencies_api.py               # –¢–µ—Å—Ç—ã API —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ run.py                               # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ requirements.txt                     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                            # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–≤—è–∑–∏ (ER)
- –¢–∞–±–ª–∏—Ü—ã:
	- `user` (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL)
	- `currency` (id INTEGER PRIMARY KEY AUTOINCREMENT, num_code TEXT, char_code TEXT, name TEXT, value FLOAT, nominal INTEGER)
	- `user_currency` (id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER, currency_id INTEGER, FOREIGN KEYs —Å ON DELETE CASCADE)
- –û—Ç–Ω–æ—à–µ–Ω–∏—è: `user` 1..* <-> *..1 `user_currency` *..1 <-> 1..* `currency` (–º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º —á–µ—Ä–µ–∑ user_currency)

## –ü—Ä–∏–º–µ—Ä—ã SQL (CRUD) ‚Äî –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ üîß
1) Create ‚Äî –≤—Å—Ç–∞–≤–∫–∞ –≤–∞–ª—é—Ç—ã
```
INSERT INTO currency (num_code, char_code, name, value, nominal)
VALUES ('840', 'USD', '–î–æ–ª–ª–∞—Ä –°–®–ê', 90.0, 1);
```
2) Read ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤–∞–ª—é—Ç—É –ø–æ ID
```
SELECT * FROM currency WHERE id = 1;
```
3) Update ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç—ã
```
UPDATE currency SET value = 95.5 WHERE id = 1;
```
4) Delete ‚Äî —É–¥–∞–ª–∏—Ç—å –≤–∞–ª—é—Ç—É
```
DELETE FROM currency WHERE id = 1;
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã `?` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `cursor.execute(sql, (value, id))`) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è SQL-–∏–Ω—ä–µ–∫—Ü–∏–π.

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
	 ```pwsh
	 python -m pip install -r requirements.txt
	 ```
2. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
	 ```pwsh
	 python run.py
	 ```
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:8000

–ú–∞—Ä—à—Ä—É—Ç—ã (GET):
- `/` ‚Äî –≥–ª–∞–≤–Ω–∞—è
- `/users` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `/user?id=<id>` ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/currencies` ‚Äî —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç –∏–∑ –ë–î
- `/currency/delete?id=<id>` ‚Äî —É–¥–∞–ª–∏—Ç—å –≤–∞–ª—é—Ç—É
- `/currency/update?USD=<value>` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å –≤–∞–ª—é—Ç—ã USD
- `/currency/show` ‚Äî –≤—ã–≤–µ—Å—Ç–∏ –≤–∞–ª—é—Ç—ã –≤ –ª–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏ (–æ—Ç–ª–∞–¥–∫–∞)
- `/author` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ

## –¢–µ—Å—Ç—ã –∏ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞ ‚Äî unittest
- –§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤:
	- `test_models.py` ‚Äî —Ç–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –≥–µ—Ç—Ç–µ—Ä—ã/—Å–µ—Ç—Ç–µ—Ä—ã)
	- `test_currencies_api.py` ‚Äî —Ç–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ (—Å `unittest.mock` –¥–ª—è `urllib.request.urlopen`)
	- `test_server.py` ‚Äî —Ç–µ—Å—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ (CurrencyRatesCRUD –∏ CurrencyController), –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å `:memory:` SQLite

–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã:
```pwsh
python -m unittest -v
```
---

–°–º–∏—Ä–Ω–æ–≤ –í–∞–¥–∏–º ‚Äî —Å—Ç—É–¥–µ–Ω—Ç –≥—Ä 4150, –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 9.
