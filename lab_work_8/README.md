# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ 8: –ö–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å Jinja2

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ—Å—Ç–æ–µ –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏ –≤–∞–ª—é—Ç. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `HTTPServer` –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **MVC** (Model-View-Controller).

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –æ—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –±–∞–Ω–∫–∞ –†–§
- **–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≤–∞–ª—é—Ç—ã** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –≤–∞–ª—é—Ç—ã
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∞–ª—é—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–ø–∏—Å–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
lab_work_8/
‚îú‚îÄ‚îÄ myapp/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ myapp.py                 # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä HTTPServer)
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ author.py            # –ú–æ–¥–µ–ª—å Author
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.py               # –ú–æ–¥–µ–ª—å App
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py              # –ú–æ–¥–µ–ª—å User
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ currency.py          # –ú–æ–¥–µ–ª—å Currency
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_currency.py     # –ú–æ–¥–µ–ª—å UserCurrency (—Å–≤—è–∑—å M2M)
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.html           # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_detail.html     # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ currencies.html      # –°–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ author.html          # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ
‚îÇ   ‚îú‚îÄ‚îÄ static/                  # –ü–∞–ø–∫–∞ –¥–ª—è CSS –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ currencies_api.py    # –§—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ test_models.py               # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ test_currencies_api.py       # –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ get_currencies
‚îú‚îÄ‚îÄ test_server.py               # –¢–µ—Å—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
‚îî‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MVC

### Models (–ú–æ–¥–µ–ª–∏)
–°–æ–¥–µ—Ä–∂–∞—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å –≥–µ—Ç—Ç–µ—Ä–∞–º–∏/—Å–µ—Ç—Ç–µ—Ä–∞–º–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:

- **Author** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ
- **App** ‚Äî –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- **User** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∏—Å—Ç–µ–º—ã
- **Currency** ‚Äî –≤–∞–ª—é—Ç–∞ (–∫–æ–¥, –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫—É—Ä—Å, –Ω–æ–º–∏–Ω–∞–ª)
- **UserCurrency** ‚Äî —Å–≤—è–∑—å "–º–Ω–æ–≥–æ –∫–æ –º–Ω–æ–≥–∏–º" –º–µ–∂–¥—É User –∏ Currency

### Views (–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)
HTML —à–∞–±–ª–æ–Ω—ã –Ω–∞ Jinja2 –≤ –ø–∞–ø–∫–µ `templates/`:

- `index.html` ‚Äî –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- `users.html` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `user_detail.html` ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –µ–≥–æ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
- `currencies.html` ‚Äî —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
- `author.html` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ

### Controller (–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)
`myapp.py` ‚Äî –∫–ª–∞—Å—Å `CurrenciesServer`:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —à–∞–±–ª–æ–Ω–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Jinja2

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install jinja2
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd lab_work_8
python -m myapp.myapp
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ `http://localhost:8000`

## –ú–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

| –ú–∞—Ä—à—Ä—É—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|
| `GET /` | –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ |
| `GET /users` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `GET /user?id=<id>` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –µ–≥–æ –ø–æ–¥–ø–∏—Å–∫–∏ |
| `GET /currencies` | –°–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç |
| `GET /author` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### Author

```python
Author(name: str, group: str)
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `name` ‚Äî –∏–º—è –∞–≤—Ç–æ—Ä–∞ (—Å—Ç—Ä–æ–∫–∞, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)
- `group` ‚Äî —É—á–µ–±–Ω–∞—è –≥—Ä—É–ø–ø–∞ (—Å—Ç—Ä–æ–∫–∞, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)

### App

```python
App(name: str, version: str, author: Author)
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `version` ‚Äî –≤–µ—Ä—Å–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `X.Y.Z`
- `author` ‚Äî –æ–±—ä–µ–∫—Ç Author

### User

```python
User(user_id: int, name: str)
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `user_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)
- `name` ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º)

### Currency

```python
Currency(
    currency_id: str,
    num_code: str,    # 3 —Ü–∏—Ñ—Ä—ã
    char_code: str,   # 3 –±—É–∫–≤—ã (ISO 4217)
    name: str,
    value: str,       # –∫—É—Ä—Å (–º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–ø—è—Ç—É—é)
    nominal: str      # –Ω–æ–º–∏–Ω–∞–ª
)
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `currency_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ID –æ—Ç –¶–ë –†–§, –Ω–∞–ø—Ä–∏–º–µ—Ä "R01235" –¥–ª—è USD)
- `num_code` ‚Äî —Ü–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–¥ (3 —Ü–∏—Ñ—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä "840" –¥–ª—è USD)
- `char_code` ‚Äî —Å–∏–º–≤–æ–ª—å–Ω—ã–π –∫–æ–¥ (3 –±—É–∫–≤—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä "USD")
- `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã
- `value` ‚Äî —Ç–µ–∫—É—â–∏–π –∫—É—Ä—Å (–º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–ø—è—Ç—É—é –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å)
- `nominal` ‚Äî –Ω–æ–º–∏–Ω–∞–ª (–∑–∞ —Å–∫–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü —É–∫–∞–∑–∞–Ω –∫—É—Ä—Å)

### UserCurrency

```python
UserCurrency(uc_id: int, user_id: int, currency_id: str)
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `uc_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏
- `user_id` ‚Äî –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ User (ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- `currency_id` ‚Äî –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ Currency (ID –≤–∞–ª—é—Ç—ã)

–†–µ–∞–ª–∏–∑—É–µ—Ç —Å–≤—è–∑—å "–º–Ω–æ–≥–æ –∫–æ –º–Ω–æ–≥–∏–º" ‚Äî –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–ª—é—Ç.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç

### –§—É–Ω–∫—Ü–∏—è `get_currencies()`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç –æ—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –±–∞–Ω–∫–∞ –†–§:

```python
from myapp.utils import get_currencies

currencies = get_currencies()
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –ø–æ–ª—è–º–∏:
# {
#     'id': 'R01235',
#     'num_code': '840',
#     'char_code': 'USD',
#     'name': '–î–æ–ª–ª–∞—Ä –°–®–ê',
#     'value': '75.5',
#     'nominal': '1'
# }
```

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `urllib.error.URLError` ‚Äî –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API
- `ET.ParseError` ‚Äî –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π XML
- `ValueError` ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤–∞–ª—é—Ç—ã –≤ –æ—Ç–≤–µ—Ç–µ

### –§—É–Ω–∫—Ü–∏—è `get_currencies_by_code()`

–ü–æ–ª—É—á–∞–µ—Ç –≤–∞–ª—é—Ç—É –ø–æ —Å–∏–º–≤–æ–ª—å–Ω–æ–º—É –∫–æ–¥—É:

```python
from myapp.utils import get_currencies_by_code

# –ü–æ–ª—É—á–∏—Ç—å USD (–ø–æ–∏—Å–∫ –±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞)
usd = get_currencies_by_code('USD')

# –ü–æ–ª—É—á–∏—Ç—å –≤–∞–ª—é—Ç—É –∏–∑ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
currencies = [...]
usd = get_currencies_by_code('USD', currencies)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
cd lab_work_8

# –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
python -m pytest test_models.py -v

# –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ get_currencies
python -m pytest test_currencies_api.py -v

# –¢–µ—Å—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
python -m pytest test_server.py -v

# –ò–ª–∏ —á–µ—Ä–µ–∑ unittest
python -m unittest discover -p "test_*.py" -v
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

#### `test_models.py`

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –º–æ–¥–µ–ª–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
- –£—Å—Ç–∞–Ω–æ–≤–∫—É —Å–≤–æ–π—Å—Ç–≤ (setters)
- –í–∞–ª–∏–¥–∞—Ü–∏—é —Ç–∏–ø–æ–≤ –∏ –∑–Ω–∞—á–µ–Ω–∏–π
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ (equality, hashing)

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:**
```python
def test_author_creation(self):
    """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ Author."""
    author = Author(name="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤", group="P3120")
    self.assertEqual(author.name, "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤")

def test_author_name_invalid_type(self):
    """–¢–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–º–µ–Ω–∏ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ç–∏–ø–æ–º."""
    author = Author(name="–ò–≤–∞–Ω", group="P3120")
    with self.assertRaises(TypeError):
        author.name = 123

def test_currency_value_with_comma(self):
    """–¢–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∫—É—Ä—Å–∞ —Å –∑–∞–ø—è—Ç–æ–π."""
    currency = Currency(...)
    currency.value = "75,5"
    self.assertEqual(currency.value, 75.5)
```

#### `test_currencies_api.py`

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç:
- –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- –ü–∞—Ä—Å–∏–Ω–≥ XML
- –ü–æ–∏—Å–∫ –≤–∞–ª—é—Ç—ã –ø–æ –∫–æ–¥—É

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:**
```python
@patch('urllib.request.urlopen')
def test_get_currencies_success(self, mock_urlopen):
    """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç."""
    # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º mock
    mock_response = MagicMock()
    mock_response.read.return_value = valid_xml.encode('utf-8')
    
    currencies = get_currencies()
    self.assertEqual(len(currencies), 2)
```

#### `test_server.py`

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≤–∞–ª—é—Ç
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
python -m myapp.myapp
```

–í—ã–≤–æ–¥:
```
============================================================
üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: CurrenciesListApp v1.0.0
üë§ –ê–≤—Ç–æ—Ä: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (P3120)
============================================================
üìç –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:8000
üìç –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: http://localhost:8000/
üìç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: http://localhost:8000/users
üìç –í–∞–ª—é—Ç—ã: http://localhost:8000/currencies
üìç –û–± –∞–≤—Ç–æ—Ä–µ: http://localhost:8000/author
============================================================
```

### –ó–∞–ø—Ä–æ—Å—ã –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

```bash
# –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
curl http://localhost:8000/

# –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
curl http://localhost:8000/users

# –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl http://localhost:8000/user?id=1

# –¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
curl http://localhost:8000/currencies

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ
curl http://localhost:8000/author
```

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

### PEP 8
- –î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 88 —Å–∏–º–≤–æ–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–π
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã (4 –ø—Ä–æ–±–µ–ª–∞)

### PEP 257 (Docstrings)
–í—Å–µ –º–æ–¥—É–ª–∏, –∫–ª–∞—Å—Å—ã, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç docstrings –≤ —Ñ–æ—Ä–º–∞—Ç–µ Google:

```python
def get_currencies() -> List[Dict[str, Any]]:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç –æ—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –±–∞–Ω–∫–∞ –†–§.
    
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –±–∞–Ω–∫–∞ –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏.
    
    Returns:
        –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤–∞–ª—é—Ç–∞—Ö.
        
    Raises:
        urllib.error.URLError: –ï—Å–ª–∏ –Ω–µ —É–¥–∞—ë—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API.
        ValueError: –ï—Å–ª–∏ –≤ XML –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è.
    """
```

### Type Hints (–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤)
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤:

```python
def __init__(self, name: str, group: str) -> None:
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç Author."""
    self.name = name
    self.group = group

def get_query_param(
    query_params: Dict[str, List[str]],
    param_name: str,
    param_type: type = str,
) -> Optional[Any]:
    """–ü–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä query —Å—Ç—Ä–æ–∫–∏."""
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Jinja2 –æ–¥–∏–Ω —Ä–∞–∑

–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —à–∞–±–ª–æ–Ω—ã Jinja2 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```python
env = Environment(
    loader=PackageLoader("myapp", "templates"),
    autoescape=select_autoescape(),
)

# –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –æ–¥–∏–Ω —Ä–∞–∑
template_index = env.get_template("index.html")
template_users = env.get_template("users.html")
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç

–í–∞–ª—é—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

```python
CurrenciesServer.currencies_cache = []
CurrenciesServer.currencies_cache_lock = threading.Lock()
```

### –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ —Ä–∞–∑–±–æ—Ä `self.path` –∏ `urllib.parse.parse_qs`:

```python
parsed_url = urlparse(self.path)
path = parsed_url.path
query_params = parse_qs(parsed_url.query)

if path == "/":
    self._handle_index()
elif path == "/users":
    self._handle_users()
elif path == "/user":
    user_id = self._get_query_param(query_params, "id", int)
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQLite –∏–ª–∏ PostgreSQL
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **–ò—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–æ–≤** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤
4. **–ì—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é Chart.js
5. **API** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ RESTful API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
6. **WebSocket** ‚Äî —Ä–µ–∞–ª-—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤

## –ê–≤—Ç–æ—Ä

–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤  
–ì—Ä—É–ø–ø–∞: P3120

## –õ–∏—Ü–µ–Ω–∑–∏—è

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –∫—É—Ä—Å—É Python. 2024 –≥.

## –°—Å—ã–ª–∫–∏

- [HTTP Server Python Documentation](https://docs.python.org/3/library/http.server.html)
- [Jinja2 Documentation](https://jinja.palletsprojects.com/)
- [–¶–ë –†–§ API](https://www.cbr-xml-daily.ru/)
- [PEP 8 ‚Äî Style Guide for Python Code](https://www.python.org/dev/peps/pep-0008/)
- [PEP 257 ‚Äî Docstring Conventions](https://www.python.org/dev/peps/pep-0257/)
